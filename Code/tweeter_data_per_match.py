# -*- coding: utf-8 -*-
"""tweeter_data_per_match.ipynb

Automatically generated by Colaboratory.

Original file is located at
    https://colab.research.google.com/drive/1rvabZXiaL5fQamoZaWzsLnwjaInJoYmQ
"""

import pandas as pd
import requests
from bs4 import BeautifulSoup
import re

dataFrame = pd.read_csv('/content/league_match_data.csv')

dataFrame = dataFrame.drop(['Unnamed: 0'], axis = 1)

dataFrame

team_match_dates = {}
for i in range(380):
  team1 = dataFrame['Home_Team'][i]
  team2 = dataFrame['Away_Team'][i]
  date = dataFrame['Date'][i]
  if team1 not in team_match_dates:
    team_match_dates[team1] = []
  if team2 not in team_match_dates:
    team_match_dates[team2] = []

  team_match_dates[team1].append(date)
  team_match_dates[team2].append(date)

Teams = set(dataFrame['Home_Team'])

Teams

Team_HashTags = {}
Team_HashTags['Liverpool'] = ['#liverpoolfc','#lfc', '#TheReds','#LiverpoolFC','#LFC']
Team_HashTags['Everton'] = ['#evertonFC', '#EFC','#evertonfc','#efc','#EvertonFC']
Team_HashTags['Chelsea'] = ['#ChelseaFC', '#CFC','#CFCXMAS','#chelseaFC','#chelseafc']
Team_HashTags['Brighton and Hove Albion'] = ['#brightonFC', '#brightonfc', '#BrightonFC','#bhafc','#BHAFC']
Team_HashTags['Tottenham Hotspur'] = ['#TottenhamFC', '#THFC', '#SPURS', '#COYS' ,'#TOTMCI']
Team_HashTags['Leicester City'] = ['#LeicesterCityFC', '#LCFC','#lcfc','#LFC','#leicestercityfc']
Team_HashTags['Norwich City'] = ['#NorwichCityFC', '#NWCFC','#norwichcityfc','#ncfc','#NCFC']
Team_HashTags['Southampton'] = ['#SouthamptonFC', '#SaintsFC','#Southampton','#southampton','#southamptonfc']
Team_HashTags['Arsenal'] = ['#ArsenalFC','#Gunners', '#coyg', '#afc', '#arsenal']
Team_HashTags['Burnley'] = ['#Burnley', '#BurnleyFC','#burnleyfc','#Clarets','#burnleyFC']
Team_HashTags['Watford'] = ['#Watford', '#WatfordFC', '#WFFC','#WFC','#watford']
Team_HashTags['Aston Villa'] = ['#AstonVilla', '#AstonVillaFC', '#AVFC','#aston','#villa']
Team_HashTags['Crystal Palace'] = ['#CrystalPalace', '#CPFC','#crystalpalace','#crystal','#Crystal']
Team_HashTags['Manchester United'] = ['#ManchesterUnited', '#mufc','#manunited','#Manchester','#MUFC']
Team_HashTags['Wolverhampton Wanderers'] = ['#Wolves', '#wolvesFC','#wolveswanderers','#Wolverhampton','#wolves']
Team_HashTags['Leeds United'] = ['#LeedsUnited', '#LeedsUnitedFC', '#LUFC','#leeds','#lufc']
Team_HashTags['Brentford'] = ['#Brentford', '#brentford', '#BFFC','#BrentfordFC','#brentfordfc']
Team_HashTags['Manchester City'] = ['#ManchesterCity', '#ManCity','#mcfc','#MCFC','#manchestercity']
Team_HashTags['West Ham United'] = ['#westham', '#WesthamFC', '#Hammers','#Ham','#westhamunited']
Team_HashTags['Newcastle United'] = ['#NewcastleUnited', '#NCUnited', '#NCFC','#nufc','#newcastle']
print(len(Team_HashTags))

Team_HashTags = {}
Team_HashTags['Liverpool'] = ['#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc']
Team_HashTags['Everton'] = ['#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC']
Team_HashTags['Chelsea'] = ['#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC']
Team_HashTags['Brighton and Hove Albion'] = ['#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC']
Team_HashTags['Tottenham Hotspur'] = ['#COYS','#thfc','#TottenhamFC','#coys','#SPURS']
Team_HashTags['Leicester City'] = ['#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc']
Team_HashTags['Norwich City'] = ['#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc']
Team_HashTags['Southampton'] = ['#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC']
Team_HashTags['Arsenal'] = ['#AFC','#afc','#ArsenalFC','#Gunners','#coyg']
Team_HashTags['Burnley'] = ['#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC']
Team_HashTags['Watford'] = ['#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc']
Team_HashTags['Aston Villa'] = ['#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc']
Team_HashTags['Crystal Palace'] = ['#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC']
Team_HashTags['Manchester United'] = ['#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC']
Team_HashTags['Wolverhampton Wanderers'] = ['#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc']
Team_HashTags['Leeds United'] = ['#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc']
Team_HashTags['Brentford'] = ['#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC']
Team_HashTags['Manchester City'] = ['#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC']
Team_HashTags['West Ham United'] = ['#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers']
Team_HashTags['Newcastle United'] = ['#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC']
print(len(Team_HashTags))

hashtags = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }

!pip install snscrape

import snscrape.modules.twitter as sntwitter
from datetime import datetime
from datetime import date
from datetime import timedelta
import re
import nltk
import string
nltk.download('stopwords')

stopword = nltk.corpus.stopwords.words('english')
ps = nltk.PorterStemmer()

def clean_text(text):
    text_lc = "".join([word.lower() for word in text if word not in string.punctuation]) # remove puntuation
    text_rc = re.sub('[0-9]+', '', text_lc)
    regrex_pattern = re.compile(pattern = "["
        u"\U0001F600-\U0001F64F"  # emoticons
        u"\U0001F300-\U0001F5FF"  # symbols & pictographs
        u"\U0001F680-\U0001F6FF"  # transport & map symbols
        u"\U0001F1E0-\U0001F1FF"  # flags (iOS)
                           "]+", flags = re.UNICODE)
    text_rc = regrex_pattern.sub(r'',text_rc)
    tokens = re.split('\W+', text_rc)    # tokenization
    text = [word for word in tokens if word not in stopword] 
    return ' '.join(text)

!pip install transformers
from transformers import pipeline
sentiment_analysis = pipeline(model="cardiffnlp/twitter-roberta-base-sentiment-latest")

final_df.to_csv('final_tweeter_data.csv', index = False)

Tweets_data = {'Date' : [], 'Team':[],'content' : []}

teamName = 'Liverpool'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Everton'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Chelsea'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Brighton and Hove Albion'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Tottenham Hotspur'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Leicester City'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Norwich City'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Southampton'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Arsenal'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Burnley'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Watford'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Aston Villa'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Crystal Palace'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Manchester United'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Manchester City'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Brentford'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Leeds United'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])
print(len(values))
for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'West Ham United'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Newcastle United'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC','#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

teamName = 'Wolverhampton Wanderers'
values = team_match_dates[teamName]
hashtag = Team_HashTags[teamName]
newHashTagSet = {'#LFC','#lfc','#LiverpoolFC','#TheReds','#liverpoolfc',
 '#EFC','#efc','#EvertonFC','#evertonfc','#evertonFC',
'#CFC','#cfc','#ChelseaFC','#chelseafc','#chelseaFC',
'#BHAFC','#bhafc','#BrightonFC','#brightonfc','#brightonFC',
'#COYS','#thfc','#TottenhamFC','#coys','#SPURS',
'#LCFC','#lcfc','#LeicesterFC','#LeicesterCityFC','#leicestercityfc',
'#ncfc','#NCFC','#NWCFC','#NorwichCityFC','#norwichcityfc',
'#SaintsFC','#saintsfc','#SouthamptonFC','#southamptonfc','#southamptonFC',
'#AFC','#afc','#ArsenalFC','#Gunners','#coyg',
 '#Clarets','#clarets','#BurnleyFC''#burnleyfc','#burnleyFC',
'#WatfordFC','#watfordfc','#WatFordFC','#WFFC','#wffc',
 '#avfc','#AVFC','#AstonFC','#villafc','#astonvillafc',
 '#CPFC','#cpfc','#CrystalPalaceFC','#crystalpalacefc','#CrystalFC',
 '#MUFC','#mufc','#ManUnitedFC','#manunitedfc','#ManUtdFC',
 '#wolvesFC','#wolvesfc','#wolveswanderers','#WolverhamptonFC','#wolverhamptonfc',
 '#LUFC', '#lufc','#LeedsUnitedFC','#leedunitedfc','#leedsfc',
 '#BFFC', '#bffc','#BrentfordFC','#brentfordfc','#brentfordFC',
'#MCFC','#mcfc','#ManCityFC','#mancityfc','#ManchesterCityFC',
 '#WHUFC','#whufc','#WesthamFC','#westhamunitedfc','#Hammers',
'#NUFC','#nufc','#NewcastleFC','#NCUnitedFC','#NewcastleUnitedFC' }
newHashTagSet.remove(hashtag[0])
newHashTagSet.remove(hashtag[1])
newHashTagSet.remove(hashtag[2])
newHashTagSet.remove(hashtag[3])
newHashTagSet.remove(hashtag[4])

for date in values:
    matchDate = (datetime.strptime(date, '%Y-%m-%d').date())
    prevDate = (matchDate - timedelta(days = 2)).strftime("%Y-%m-%d")
    matchDate = matchDate.strftime("%Y-%m-%d")
    totalTweets = 0
    query = f"{hashtag[0]} OR {hashtag[1]} OR {hashtag[2]} OR {hashtag[3]} OR {hashtag[4]} -has:link lang:en -is:retweet since:{prevDate} until:{matchDate}"
    q = sntwitter.TwitterSearchScraper(query)
    total = 0
    for tweet in q.get_items():
        total = total + 1
        content = tweet.content
        mila = False
        for otherHashTags in newHashTagSet:
            if otherHashTags in content:
                mila = True
                break
        if mila == True:
            continue
                
        clean_tweet = clean_text(tweet.content)
        Tweets_data['Date'].append(date)
        Tweets_data['Team'].append(teamName)
        Tweets_data['content'].append(clean_tweet)
        totalTweets = totalTweets + 1
        if totalTweets > 2000:
            break
    print(total)

len(Tweets_data['Date'])

newData  = pd.DataFrame.from_dict(Tweets_data)
newData.to_csv('tweets4.csv', index = False)

df1 = pd.read_csv('/content/partial_data.csv')
df2 = pd.read_csv('/content/partial_data1.csv')
df3 = pd.read_csv('/content/partial_data2.csv')
df4 = pd.read_csv('/content/partial_data3.csv')
df5 = pd.read_csv('/content/partial_data4.csv')
df6 = pd.read_csv('/content/partial_data5.csv')
df7 = pd.read_csv('/content/partial_data6.csv')
df8 = pd.read_csv('/content/partial_data7.csv')
df9 = pd.read_csv('/content/partial_data8.csv')

df = df1.append(df2,ignore_index = True)

df = df.append(df3,ignore_index=True)

df = df.append(df4, ignore_index = True)

df = df.append(df5,ignore_index = True)

df = df.append(df6,ignore_index = True)

df = df.append(df7,ignore_index = True)

df = df.append(df8,ignore_index = True)

df = df.append(df9,ignore_index = True)

df

df = df.dropna().reset_index()

for i in range(760):
  date = df['Date'][i]
  dateList = date.split('-')
  if len(dateList[2]) == 4:
    dateList.reverse()
    s = '-'.join(dateList)
    df['Date'][i] = s

df.to_csv('final_sentiment_data_per_match.csv',index = False)

df = pd.read_csv('/content/final_tweets_data.csv')



for team in Teams:
  print(team)
  if team == 'Manchester City' or  team == 'Watford' or  team == 'Newcastle United' or team == 'Chelsea' or team == 'Burnley' or team == 'Manchester United' or team == 'Crystal Palace' or team == 'West Ham United' or team == 'Aston Villa' or  team == 'Tottenham Hotspur' or team == 'Leeds United' or  team == 'Brighton and Hove Albion' or team == 'Wolverhampton Wanderers' or team == 'Everton' or team == 'Norwich City' or team == 'Leicester City' or team == 'Southampton' or team == 'Brentford' or team == 'Arsenal':
    continue
  dates = team_match_dates[team]
  df_team = df[df['Team'] == team]
  print(len(df_team['Date']))
  for date in dates:
     df_date = df_team[df_team['Date'] == date].reset_index().drop(['index'], axis = 1)
     sz = len(df_date['Date'])
     print(sz)
     pos = 0
     neg = 0
     for i in range(sz):
       content = df_date['content'][i]
       sentiment = sentiment_analysis(content)
       label = sentiment[0]['label']
       if label == 'positive':
         pos = pos + 1
       if label == 'negative':
         neg = neg + 1
     Tweets_Polarity['Team'].append(team)
     Tweets_Polarity['Date'].append(date)
     Tweets_Polarity['PosTweets'].append(pos)
     Tweets_Polarity['NegTweets'].append(neg)

df = pd.DataFrame.from_dict(Tweets_Polarity)
df.to_csv('partial_data8.csv',index = False)

Tweets_Polarity

df = df.drop_duplicates()

len(df['Date'])

df1.to_csv('final_tweets_data.csv',index = False)

df1 = pd.read_csv('new_team_data.csv')

df2 = pd.read_csv('Downloads/final_sentiment_data_per_match.csv').drop(['index'], axis = 1)

teams = set(df2['Team'])

newDict = {'Date' : [], 'Home_Team' : [], 'Away_Team' : [], 'Home_Pos' : [], 'Away_Pos' : [], 'Home_Neg' : [], 'Away_Neg' : [], 'Result' : []
          }

teamTweetData = {}
for team in teams:
    teamTweetData[team] = {} 
for i in range(760):
    date = df2['Date'][i]
    team = df2['Team'][i]
    Pos = df2['PosTweets'][i]
    Neg = df2['NegTweets'][i]
    listOfDates = list(teamTweetData[team].keys())
    if date not in listOfDates:
        teamTweetData[team][date] = []
    teamTweetData[team][date].append(Pos)
    teamTweetData[team][date].append(Neg)

for i in range(380):
    date = df1['Date'][i]
    Home_Team = df1['Home_Team'][i]
    Away_Team = df1['Away_Team'][i]
    Result = df1['Result'][i]
    hpos = float(teamTweetData[Home_Team][date][0])
    hneg = float(teamTweetData[Home_Team][date][1])
    apos = float(teamTweetData[Away_Team][date][0])
    aneg = float(teamTweetData[Away_Team][date][1])
    newDict['Date'].append(date)
    newDict['Home_Team'].append(Home_Team)
    newDict['Away_Team'].append(Away_Team)
    newDict['Home_Pos'].append(hpos)
    newDict['Home_Neg'].append(hneg)   
    newDict['Away_Pos'].append(apos)
    newDict['Away_Neg'].append(aneg)
    newDict['Result'].append(Result)

targetDf = pd.DataFrame.from_dict(newDict)
targetDf.to_csv('final_tweetData_per_match.csv', index = False)